<!doctype html>
<html lang="nl">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width,initial-scale=1">
  <title>Pressure & Density Altitude Visual Calculator</title>
  <style>
    body {
      font-family: 'Inter', sans-serif;
      background: linear-gradient(135deg, #e0f2ff, #f7fff7);
      color: #222;
      display: flex;
      align-items: center;
      justify-content: center;
      height: 100vh;
      margin: 0;
    }
    .container {
      background: white;
      border-radius: 16px;
      box-shadow: 0 10px 25px rgba(0,0,0,0.1);
      padding: 24px;
      max-width: 900px;
      width: 100%;
      display: flex;
      flex-direction: column;
      gap: 20px;
    }
    h1 {
      font-size: 1.5rem;
      margin-bottom: 10px;
      text-align: center;
      color: #00695c;
    }
    .inputs {
      display: flex;
      flex-wrap: wrap;
      gap: 16px;
      justify-content: center;
    }
    .input-group {
      display: flex;
      flex-direction: column;
      gap: 6px;
    }
    label {
      font-size: 0.9rem;
      color: #333;
    }
    input, select {
      padding: 8px 10px;
      border-radius: 8px;
      border: 1px solid #ccc;
      font-size: 1rem;
      transition: border-color 0.2s ease;
    }
    input:focus, select:focus {
      border-color: #00a67e;
      outline: none;
    }
    .results {
      text-align: center;
    }
    .result-value {
      font-size: 1.4rem;
      font-weight: bold;
      color: #00796b;
    }
    .note {
      font-size: 0.85rem;
      color: #666;
    }
    canvas {
      width: 100%;
      height: 240px;
      background: linear-gradient(180deg, #b2dfdb, #e0f7fa);
      border-radius: 10px;
    }
  </style>
</head>
<body>
  <div class="container">
    <h1>Pressure & Density Altitude Visual Calculator</h1>
    <div class="inputs">
      <div class="input-group">
        <label for="elev">Elevation</label>
        <input id="elev" type="number" value="150" step="1" min="-500">
      </div>
      <div class="input-group">
        <label for="unit">Eenheid</label>
        <select id="unit">
          <option value="ft">Feet</option>
          <option value="m">Meter</option>
        </select>
      </div>
      <div class="input-group">
        <label for="qnh">QNH (hPa)</label>
        <input id="qnh" type="number" value="1005" step="0.1" min="800" max="1100">
      </div>
      <div class="input-group">
        <label for="temp">Temperatuur (°C)</label>
        <input id="temp" type="number" value="15" step="0.1" min="-50" max="50">
      </div>
    </div>

    <canvas id="visual"></canvas>

    <div class="results">
      <div>QNH verschil: <span id="delta"></span> hPa</div>
      <div class="result-value">Pressure Altitude: <span id="pa"></span></div>
      <div class="result-value" style="color:#d84315;">Density Altitude: <span id="da"></span></div>
      <div class="note">PA = Elevation + (1013 − QNH) × 27 ft/hPa<br>DA = PA + (120 × (OAT − ISA Temp))</div>
    </div>
  </div>

  <script>
    const elev = document.getElementById('elev');
    const unit = document.getElementById('unit');
    const qnh = document.getElementById('qnh');
    const temp = document.getElementById('temp');
    const deltaOut = document.getElementById('delta');
    const paOut = document.getElementById('pa');
    const daOut = document.getElementById('da');
    const canvas = document.getElementById('visual');
    const ctx = canvas.getContext('2d');

    function mToFt(m) { return m * 3.28084; }
    function ftToM(ft) { return ft / 3.28084; }

    function drawVisual(elevFt, paFt, daFt) {
      const width = canvas.width = canvas.clientWidth;
      const height = canvas.height = canvas.clientHeight;
      ctx.clearRect(0, 0, width, height);

      const maxAlt = Math.max(daFt * 1.1, 2000); // schaal past zich automatisch aan
      const scale = height / maxAlt;

      const elevY = height - elevFt * scale;
      const paY = height - paFt * scale;
      const daY = height - daFt * scale;

      // grond
      ctx.fillStyle = '#004d40';
      ctx.fillRect(0, height - 10, width, 10);

      // elevation
      ctx.fillStyle = '#0288d1';
      ctx.fillRect(width/4, elevY - 3, width/2, 6);
      ctx.fillText(`Elevation: ${Math.round(elevFt)} ft`, 10, elevY - 8);

      // pressure altitude
      ctx.fillStyle = '#ef6c00';
      ctx.fillRect(width/4 - 10, paY - 2, width/2 + 20, 4);
      ctx.fillText(`PA: ${Math.round(paFt)} ft`, 10, paY - 10);

      // density altitude
      ctx.fillStyle = '#c62828';
      ctx.fillRect(width/4 - 20, daY - 2, width/2 + 40, 3);
      ctx.fillText(`DA: ${Math.round(daFt)} ft`, 10, daY - 12);
    }

    function calculate() {
      let elevation = parseFloat(elev.value) || 0;
      const qnhVal = parseFloat(qnh.value) || 1013;
      const oat = parseFloat(temp.value) || 15;
      const delta = 1013 - qnhVal;
      let elevFt = unit.value === 'm' ? mToFt(elevation) : elevation;
      const paFt = elevFt + delta * 27;

      // ISA temp op hoogte (afname 2°C per 1000 ft)
      const isaTemp = 15 - (paFt / 1000 * 2);
      const daFt = paFt + 120 * (oat - isaTemp);

      deltaOut.textContent = delta.toFixed(1);
      paOut.textContent = `${Math.round(paFt)} ft (${Math.round(ftToM(paFt))} m)`;
      daOut.textContent = `${Math.round(daFt)} ft (${Math.round(ftToM(daFt))} m)`;

      drawVisual(elevFt, paFt, daFt);
    }

    [elev, unit, qnh, temp].forEach(el => el.addEventListener('input', calculate));

    calculate();
  </script>
</body>
</html>
