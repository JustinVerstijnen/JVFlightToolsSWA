<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Top of Descent Calculator</title>

  <style>
    :root{
      --bg1:#0b1020;
      --bg2:#070a14;
      --card:#0f1733cc;
      --text:#eaf0ff;
      --muted:#aeb9da;
      --line:#26325f;
      --accent:#79a7ff;
      --accent2:#8bffcf;
      --danger:#ff6b8a;
      --shadow: 0 18px 60px rgba(0,0,0,.45);
      --radius: 18px;
    }

    *{ box-sizing:border-box; }
    html,body{ height:100%; }

    body{
      margin:0;
      font-family: system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial;
      color:var(--text);
      background:
        radial-gradient(900px 500px at 20% 15%, rgba(121,167,255,.25), transparent 60%),
        radial-gradient(900px 500px at 80% 25%, rgba(139,255,207,.14), transparent 60%),
        linear-gradient(180deg, var(--bg1), var(--bg2));
      display:flex;
      justify-content:center;
      align-items:center;
      padding:24px;
    }

    .wrap{ width:min(920px,100%); }

    header{
      display:flex;
      justify-content:space-between;
      gap:16px;
      margin-bottom:16px;
    }

    h1{ margin:0; font-size:28px; }

    .subtitle{
      margin:6px 0 0 0;
      font-size:14px;
      color:var(--muted);
      max-width:60ch;
    }

    .pill{
      padding:8px 12px;
      border-radius:999px;
      border:1px solid rgba(38,50,95,.6);
      background:rgba(6,9,22,.4);
      font-size:12px;
    }

    .card{
      border-radius:var(--radius);
      border:1px solid rgba(38,50,95,.7);
      background:rgba(15,23,51,.85);
      box-shadow:var(--shadow);
      display:grid;
      grid-template-columns:1.1fr .9fr;
    }

    @media(max-width:850px){
      .card{ grid-template-columns:1fr; }
    }

    .pane, .results{
      padding:18px;
    }

    .pane{
      border-right:1px solid rgba(38,50,95,.6);
    }

    @media(max-width:850px){
      .pane{ border-right:none; border-bottom:1px solid rgba(38,50,95,.6); }
    }

    h2{
      margin:0 0 12px 0;
      font-size:13px;
      text-transform:uppercase;
      letter-spacing:.12em;
      color:var(--muted);
    }

    form{
      display:flex;
      flex-direction:column;
      align-items:center;
      gap:12px;
    }

    .field{
      width:min(520px,100%);
      display:flex;
      flex-direction:column;
      gap:6px;
    }

    label{ font-size:13px; color:var(--muted); }

    .hint{ font-size:12px; color:rgba(174,185,218,.8); }

    .control{
      display:grid;
      grid-template-columns:1fr auto;
      gap:10px;
    }

    input[type=number]{
      padding:12px;
      border-radius:14px;
      border:1px solid rgba(38,50,95,.8);
      background:rgba(6,9,22,.6);
      color:var(--text);
      font-size:14px;
    }

    .unit{
      padding:10px;
      border-radius:14px;
      border:1px solid rgba(38,50,95,.6);
      background:rgba(6,9,22,.35);
      font-size:12px;
      min-width:70px;
      text-align:center;
    }

    .mode{
      width:min(520px,100%);
      display:flex;
      gap:16px;
      padding:10px;
      border-radius:16px;
      border:1px solid rgba(38,50,95,.6);
      background:rgba(6,9,22,.35);
      font-size:13px;
    }

    .actions{
      width:min(520px,100%);
      display:flex;
      gap:10px;
    }

    button{
      flex:1;
      padding:12px;
      border-radius:16px;
      border:1px solid rgba(38,50,95,.8);
      background:rgba(6,9,22,.6);
      color:var(--text);
      font-weight:600;
      cursor:pointer;
    }

    .primary{
      border-color:rgba(121,167,255,.9);
      background:linear-gradient(180deg, rgba(121,167,255,.25), rgba(121,167,255,.1));
    }

    .summary{
      display:grid;
      grid-template-columns:1fr 1fr;
      gap:12px;
    }

    @media(max-width:420px){
      .summary{ grid-template-columns:1fr; }
    }

    .tile{
      padding:14px;
      border-radius:18px;
      border:1px solid rgba(38,50,95,.6);
      background:rgba(6,9,22,.35);
    }

    .k{
      font-size:12px;
      color:rgba(174,185,218,.9);
    }

    .v{
      font-size:22px;
      font-weight:700;
    }

    .warn{
      margin-top:12px;
      padding:10px;
      border-radius:14px;
      border:1px solid rgba(255,107,138,.5);
      background:rgba(255,107,138,.12);
      display:none;
      font-size:13px;
    }

    .warn.show{ display:block; }

    .details{
      margin-top:12px;
      padding:12px;
      border-radius:16px;
      border:1px solid rgba(38,50,95,.6);
      background:rgba(6,9,22,.3);
      font-size:13px;
      line-height:1.45;
    }
  </style>
</head>

<body>
<div class="wrap">
<header>
  <div>
    <h1>Top of Descent</h1>
    <p class="subtitle">
      Simple Top of Descent calculator using common rules of thumb.
      Enter your altitudes, speeds and wind to estimate TOD distance and descent time.
    </p>
  </div>
  <div class="pill">✈️ Wind: + tailwind / − headwind</div>
</header>

<div class="card">
<section class="pane">
<h2>Inputs</h2>

<form id="todForm">
  <div class="field">
    <label>Start altitude <span class="hint">(cruise)</span></label>
    <div class="control">
      <input id="startAlt" type="number" value="35000">
      <div class="unit">ft</div>
    </div>
  </div>

  <div class="field">
    <label>Target altitude <span class="hint">(STAR / IAF)</span></label>
    <div class="control">
      <input id="endAlt" type="number" value="3000">
      <div class="unit">ft</div>
    </div>
  </div>

  <div class="field">
    <label>Start speed <span class="hint">(knots)</span></label>
    <div class="control">
      <input id="startSpd" type="number" value="280">
      <div class="unit">kt</div>
    </div>
  </div>

  <div class="field">
    <label>Target speed</label>
    <div class="control">
      <input id="endSpd" type="number" value="220">
      <div class="unit">kt</div>
    </div>
  </div>

  <div class="field">
    <label>Wind component</label>
    <div class="control">
      <input id="wind" type="number" value="0">
      <div class="unit">kt</div>
    </div>
  </div>

  <div class="mode">
    <label><input type="radio" name="mode" value="glide" checked> Glide slope</label>
    <label><input type="radio" name="mode" value="vs"> Vertical speed</label>
  </div>

  <div class="field" id="glideField">
    <label>Glide slope</label>
    <div class="control">
      <input id="glide" type="number" value="3.0" step="0.1">
      <div class="unit">°</div>
    </div>
  </div>

  <div class="field" id="vsField" style="display:none">
    <label>Vertical speed</label>
    <div class="control">
      <input id="vs" type="number" value="2000">
      <div class="unit">fpm</div>
    </div>
  </div>

  <div class="actions">
    <button class="primary">Calculate</button>
    <button type="button" id="resetBtn">Reset</button>
  </div>
</form>
</section>

<section class="results">
<h2>Overview</h2>

<div class="summary">
  <div class="tile">
    <div class="k">Top of Descent distance</div>
    <div class="v" id="outTod">— NM</div>
  </div>
  <div class="tile">
    <div class="k">Estimated descent time</div>
    <div class="v" id="outTime">— min</div>
  </div>
  <div class="tile">
    <div class="k">Required vertical speed</div>
    <div class="v" id="outVs">— fpm</div>
  </div>
  <div class="tile">
    <div class="k">Estimated ground speed</div>
    <div class="v" id="outGs">— kt</div>
  </div>
</div>

<div class="warn" id="warnBox"></div>

<div class="details">
<b>Assumptions</b><br>
• Altitude loss → distance using glide angle and 1 NM ≈ 6076 ft<br>
• Deceleration → 1 NM per 10 kt speed reduction<br>
• Wind correction → 1 NM per 10 kt (tailwind + / headwind −)<br><br>
<b>This is an estimate.</b> Always follow charts, FMS and operational procedures.
</div>

</section>
</div>
</div>

<script>
const ftPerNm = 6076.12;

function get(id){ return parseFloat(document.getElementById(id).value); }

function calc(){
  const startAlt=get("startAlt"), endAlt=get("endAlt");
  const startSpd=get("startSpd"), endSpd=get("endSpd");
  const wind=get("wind");
  if(endAlt>=startAlt) return warn("Target altitude must be lower than start altitude");

  const altDiff=startAlt-endAlt;
  const avgSpd=(startSpd+endSpd)/2;
  const gs=Math.max(60, avgSpd+wind);

  const decelNm=(startSpd-endSpd)/10;
  const windNm=wind/10;

  let todNm, timeMin, vs;
  const mode=document.querySelector("input[name=mode]:checked").value;

  if(mode==="glide"){
    const glide=get("glide")*Math.PI/180;
    todNm=altDiff/(Math.tan(glide)*ftPerNm)+decelNm+windNm;
    timeMin=(todNm/gs)*60;
    vs=altDiff/timeMin;
  }else{
    vs=get("vs");
    timeMin=altDiff/vs;
    todNm=gs*(timeMin/60)+decelNm+windNm;
  }

  out("outTod",todNm.toFixed(1)+" NM");
  out("outTime",timeMin.toFixed(1)+" min");
  out("outVs",Math.round(vs)+" fpm");
  out("outGs",Math.round(gs)+" kt");
  warn("");
}

function out(id,val){ document.getElementById(id).textContent=val; }
function warn(msg){
  const w=document.getElementById("warnBox");
  w.textContent=msg;
  w.classList.toggle("show",!!msg);
}

document.getElementById("todForm").onsubmit=e=>{e.preventDefault();calc();};
document.getElementById("resetBtn").onclick=()=>location.reload();
document.querySelectorAll("input[name=mode]").forEach(r=>r.onchange=()=>{
  glideField.style.display=r.value==="glide"?"":"none";
  vsField.style.display=r.value==="vs"?"":"none";
});
</script>
</body>
</html>
